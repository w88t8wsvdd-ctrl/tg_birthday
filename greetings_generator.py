"""
–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–π —Å –¥–Ω—è–º–∏ —Ä–æ–∂–¥–µ–Ω–∏—è.
–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥: —Å–æ–±–∏—Ä–∞–µ–º –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è –∏–∑ –≥–æ—Ç–æ–≤—ã—Ö —á–∞—Å—Ç–µ–π.
"""

import random
from typing import List, Optional

# –ë–ê–ó–û–í–´–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´ –î–õ–Ø –ì–ï–ù–ï–†–ê–¶–ò–ò –ü–û–ó–î–†–ê–í–õ–ï–ù–ò–ô

# –ù–∞—á–∞–ª–∞ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–π
GREETING_STARTS = [
    "–î–æ—Ä–æ–≥–æ–π {name}, –æ—Ç –≤—Å–µ–π –¥—É—à–∏",
    "–£–≤–∞–∂–∞–µ–º—ã–π {name}, –∏—Å–∫—Ä–µ–Ω–Ω–µ",
    "–õ—é–±–∏–º—ã–π {name}, —Å–µ—Ä–¥–µ—á–Ω–æ",
    "–î–æ—Ä–æ–≥–∞—è {name}, —Å —Ç–µ–ø–ª–æ—Ç–æ–π –≤ —Å–µ—Ä–¥—Ü–µ",
    "–£–≤–∞–∂–∞–µ–º–∞—è {name}, –æ—Ç —á–∏—Å—Ç–æ–≥–æ —Å–µ—Ä–¥—Ü–∞",
    "{name}, –æ—Ç –≤—Å–µ–π –Ω–∞—à–µ–π –¥—Ä—É–∂–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏",
    "–î–æ—Ä–æ–≥–æ–π –∏–º–µ–Ω–∏–Ω–Ω–∏–∫ {name}, –æ—Ç –≤—Å–µ–≥–æ –∫–æ–ª–ª–µ–∫—Ç–∏–≤–∞",
    "{name}, –≤ —ç—Ç–æ—Ç –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã–π –¥–µ–Ω—å",
]

# –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è (–≤—Ç–æ—Ä–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ)
MAIN_GREETINGS = [
    "–ø–æ–∑–¥—Ä–∞–≤–ª—è–µ–º —Ç–µ–±—è —Å –¥–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è!",
    "–∂–µ–ª–∞–µ–º —Ç–µ–±–µ –≤—Å–µ–≥–æ —Å–∞–º–æ–≥–æ –Ω–∞–∏–ª—É—á—à–µ–≥–æ –≤ —ç—Ç–æ—Ç –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–π –¥–µ–Ω—å!",
    "–æ—Ç –≤—Å–µ–π –¥—É—à–∏ –∂–µ–ª–∞–µ–º —Å—á–∞—Å—Ç—å—è, –∑–¥–æ—Ä–æ–≤—å—è –∏ –ø—Ä–æ—Ü–≤–µ—Ç–∞–Ω–∏—è!",
    "–ø—Ä–∏–º–∏ —Å–∞–º—ã–µ —Ç—ë–ø–ª—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è –≤ —Ç–≤–æ–π –¥–µ–Ω—å!",
    "–ø—É—Å—Ç—å —ç—Ç–æ—Ç –¥–µ–Ω—å –∑–∞–ø–æ–º–Ω–∏—Ç—Å—è —Ä–∞–¥–æ—Å—Ç–Ω—ã–º–∏ –º–æ–º–µ–Ω—Ç–∞–º–∏!",
    "–∂–µ–ª–∞–µ–º, —á—Ç–æ–±—ã —ç—Ç–æ—Ç –≥–æ–¥ —Å—Ç–∞–ª –¥–ª—è —Ç–µ–±—è –æ—Å–æ–±–µ–Ω–Ω—ã–º!",
]

# –ü–æ–∂–µ–ª–∞–Ω–∏—è (—Ç—Ä–µ—Ç—å–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ)
WISHES = [
    # –ó–¥–æ—Ä–æ–≤—å–µ
    "–ö—Ä–µ–ø–∫–æ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è, –±–æ–¥—Ä–æ—Å—Ç–∏ –¥—É—Ö–∞ –∏ –Ω–µ–∏—Å—Å—è–∫–∞–µ–º–æ–π —ç–Ω–µ—Ä–≥–∏–∏!",
    "–û—Ç–ª–∏—á–Ω–æ–≥–æ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏—è, —Å–∏–ª—ã –∏ –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç–∏ –Ω–∞ –¥–æ–ª–≥–∏–µ –≥–æ–¥—ã!",
    "–ñ–µ–ª–µ–∑–Ω–æ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è, —á—Ç–æ–±—ã –Ω–∏–∫–∞–∫–∏–µ –±–æ–ª–µ–∑–Ω–∏ –Ω–µ –±–µ—Å–ø–æ–∫–æ–∏–ª–∏!",
    
    # –£—Å–ø–µ—Ö –∏ –∫–∞—Ä—å–µ—Ä–∞
    "–û—à–µ–ª–æ–º–ª—è—é—â–∏—Ö —É—Å–ø–µ—Ö–æ–≤ –≤ —Ä–∞–±–æ—Ç–µ –∏ –∫–∞—Ä—å–µ—Ä–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞!",
    "–Ø—Ä–∫–∏—Ö –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –ø–æ–±–µ–¥ –∏ –¥–æ—Å—Ç–æ–π–Ω–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–Ω–∏—è!",
    "–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤, –º—É–¥—Ä—ã—Ö —Ä–µ—à–µ–Ω–∏–π –∏ –±–ª–µ—Å—Ç—è—â–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤!",
    
    # –õ–∏—á–Ω–æ–µ —Å—á–∞—Å—Ç—å–µ
    "–õ–∏—á–Ω–æ–≥–æ —Å—á–∞—Å—Ç—å—è, —É—é—Ç–∞ –≤ –¥–æ–º–µ –∏ –≥–∞—Ä–º–æ–Ω–∏–∏ –≤ –¥—É—à–µ!",
    "–õ—é–±–≤–∏, —Ç–µ–ø–ª–∞ –∏ –≤–∑–∞–∏–º–æ–ø–æ–Ω–∏–º–∞–Ω–∏—è —Å –±–ª–∏–∑–∫–∏–º–∏ –ª—é–¥—å–º–∏!",
    "–ü—Ä–µ–∫—Ä–∞—Å–Ω–æ–≥–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è –∏ —Ä–∞–¥–æ—Å—Ç–Ω—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å!",
    
    # –§–∏–Ω–∞–Ω—Å—ã
    "–§–∏–Ω–∞–Ω—Å–æ–≤–æ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏, –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö –∏–¥–µ–π –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–≥–æ –±–ª–∞–≥–æ–ø–æ–ª—É—á–∏—è!",
    "–î–æ—Å—Ç–∞—Ç–∫–∞, —â–µ–¥—Ä—ã—Ö –±–æ–Ω—É—Å–æ–≤ –∏ –≤—ã–≥–æ–¥–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π!",
    
    # –û–±—â–∏–µ
    "–ò—Å–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –∂–µ–ª–∞–Ω–∏–π –∏ –æ—Å—É—â–µ—Å—Ç–≤–ª–µ–Ω–∏—è —Å–∞–º—ã—Ö —Å–º–µ–ª—ã—Ö –ø–ª–∞–Ω–æ–≤!",
    "–£–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–π –∏ –Ω–µ–∑–∞–±—ã–≤–∞–µ–º—ã—Ö –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–π!",
    "–í–µ—Ä–Ω—ã—Ö –¥—Ä—É–∑–µ–π, –ø–æ–Ω–∏–º–∞—é—â–∏—Ö –∫–æ–ª–ª–µ–≥ –∏ –Ω–∞–¥—ë–∂–Ω—ã—Ö –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤!",
    "–¢–≤–æ—Ä—á–µ—Å–∫–æ–≥–æ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è –∏ —Å–º–µ–ª—ã—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤!",
]

# –ó–∞–≤–µ—Ä—à–µ–Ω–∏—è (—á–µ—Ç–≤–µ—Ä—Ç–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
ENDINGS = [
    "–ü—É—Å—Ç—å –∫–∞–∂–¥—ã–π —Ç–≤–æ–π –¥–µ–Ω—å –±—É–¥–µ—Ç –Ω–∞–ø–æ–ª–Ω–µ–Ω —Ä–∞–¥–æ—Å—Ç—å—é –∏ —Å–º—ã—Å–ª–æ–º!",
    "–ñ–µ–ª–∞–µ–º, —á—Ç–æ–±—ã —É–¥–∞—á–∞ –≤—Å–µ–≥–¥–∞ –±—ã–ª–∞ –Ω–∞ —Ç–≤–æ–µ–π —Å—Ç–æ—Ä–æ–Ω–µ!",
    "–ü—É—Å—Ç—å –∞–Ω–≥–µ–ª-—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å –æ–±–µ—Ä–µ–≥–∞–µ—Ç —Ç–µ–±—è –Ω–∞ –≤—Å–µ—Ö –ø—É—Ç—è—Ö!",
    "–° –Ω–∞–∏–ª—É—á—à–∏–º–∏ –ø–æ–∂–µ–ª–∞–Ω–∏—è–º–∏ –∏ —Å–∞–º—ã–º–∏ —Ç—ë–ø–ª—ã–º–∏ —á—É–≤—Å—Ç–≤–∞–º–∏!",
    "–ë—É–¥—å —Å—á–∞—Å—Ç–ª–∏–≤(–∞) –∫–∞–∂–¥—ã–π –¥–µ–Ω—å, –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É!",
    "–ü—É—Å—Ç—å –∂–∏–∑–Ω—å –¥–∞—Ä–∏—Ç —Ç–µ–±–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∏—è—Ç–Ω—ã–µ —Å—é—Ä–ø—Ä–∏–∑—ã!",
]

# –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è –ø–æ –ø–æ–ª—É
FEMALE_SPECIFIC_WISHES = [
    "–ù–µ–∂–Ω–æ—Å—Ç–∏, –∫—Ä–∞—Å–æ—Ç—ã –∏ –∂–µ–Ω—Å–∫–æ–≥–æ —Å—á–∞—Å—Ç—å—è!",
    "–¶–≤–µ—Ç—É—â–µ–≥–æ –≤–∏–¥–∞, –æ—á–∞—Ä–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π —É–ª—ã–±–∫–∏ –∏ –ª—ë–≥–∫–æ—Å—Ç–∏!",
    "–≠–ª–µ–≥–∞–Ω—Ç–Ω–æ—Å—Ç–∏, —Å—Ç–∏–ª—è –∏ –Ω–µ–ø–æ–≤—Ç–æ—Ä–∏–º–æ–≥–æ —à–∞—Ä–º–∞!",
    "–õ—é–±—è—â–µ–π —Å–µ–º—å–∏ –∏ –¥–æ–º–∞—à–Ω–µ–≥–æ —É—é—Ç–∞!",
]

MALE_SPECIFIC_WISHES = [
    "–ú—É–∂—Å–∫–æ–π —Å–∏–ª—ã, —Ä–µ—à–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ü–µ–ª–µ—É—Å—Ç—Ä–µ–º–ª—ë–Ω–Ω–æ—Å—Ç–∏!",
    "–¢–≤—ë—Ä–¥–æ—Å—Ç–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞, –º—É–¥—Ä–æ—Å—Ç–∏ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏!",
    "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã—Ö –ø–æ–±–µ–¥ –∏ –æ—Ç–ª–∏—á–Ω–æ–π —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π —Ñ–æ—Ä–º—ã!",
    "–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –≤ —Å–µ–±–µ –∏ –ª–∏–¥–µ—Ä—Å–∫–∏—Ö –∫–∞—á–µ—Å—Ç–≤!",
]

# –°–µ–∑–æ–Ω–Ω—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è
SEASONAL_WISHES = {
    "winter": [
        "–ü—É—Å—Ç—å –∑–∏–º–∞ –±—É–¥–µ—Ç —Ç—ë–ø–ª–æ–π, –∞ –ù–æ–≤—ã–π –≥–æ–¥ - –≤–æ–ª—à–µ–±–Ω—ã–º!",
        "–ö–∞–∫ —Å–Ω–µ–∂–∏–Ω–∫–∏ –ø—É—Å—Ç—å –ø–∞–¥–∞—é—Ç —Å –Ω–µ–±–∞ –ø—Ä–∏—è—Ç–Ω—ã–µ —Å—é—Ä–ø—Ä–∏–∑—ã!",
    ],
    "spring": [
        "–ö–∞–∫ –≤–µ—Å–µ–Ω–Ω–∏–µ —Ü–≤–µ—Ç—ã, –ø—É—Å—Ç—å —Ä–∞—Å–ø—É—Å–∫–∞—é—Ç—Å—è –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏!",
        "–ü—É—Å—Ç—å –∂–∏–∑–Ω—å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è, –∫–∞–∫ –ø—Ä–∏—Ä–æ–¥–∞ –≤–µ—Å–Ω–æ–π!",
    ],
    "summer": [
        "–°–æ–ª–Ω–µ—á–Ω–æ–≥–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è –∏ —Ç—ë–ø–ª—ã—Ö –ª–µ—Ç–Ω–∏—Ö –¥–Ω–µ–π!",
        "–ü—É—Å—Ç—å –∂–∏–∑–Ω—å –±—É–¥–µ—Ç —è—Ä–∫–æ–π, –∫–∞–∫ –ª–µ—Ç–Ω–µ–µ —Å–æ–ª–Ω—Ü–µ!",
    ],
    "autumn": [
        "–ó–æ–ª–æ—Ç–æ–π –æ—Å–µ–Ω–∏ –∂–∏–∑–Ω–∏ - —Å–∞–º–æ–π –º—É–¥—Ä–æ–π –∏ –∫—Ä–∞—Å–∏–≤–æ–π!",
        "–ü—É—Å—Ç—å, –∫–∞–∫ –æ—Å–µ–Ω–Ω–∏–π —É—Ä–æ–∂–∞–π, –±—É–¥—É—Ç —â–µ–¥—Ä—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–≤–æ–µ–≥–æ —Ç—Ä—É–¥–∞!",
    ]
}

# –≠–º–æ–¥–∑–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
EMOJI_CATEGORIES = {
    "general": ["üéâ", "ü•≥", "üéä", "‚ú®", "üåü", "üéà", "üí´"],
    "celebration": ["üéÇ", "üç∞", "ü•Ç", "üçæ", "üéÅ"],
    "success": ["üèÜ", "üéØ", "‚≠ê", "üí™", "üöÄ"],
    "love": ["‚ù§Ô∏è", "üíñ", "üíù", "üíï", "üòä"],
    "seasonal": {
        "winter": ["‚õÑ", "üéÑ", "‚ùÑÔ∏è"],
        "spring": ["üå∏", "üå∑", "üåº"],
        "summer": ["‚òÄÔ∏è", "üèñÔ∏è", "üåä"],
        "autumn": ["üçÇ", "üçÅ", "üåæ"]
    }
}

class GreetingGenerator:
    """–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–π."""
    
    def __init__(self):
        self.used_combinations = set()
    
    def _get_season(self) -> str:
        """–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–µ–∫—É—â–∏–π —Å–µ–∑–æ–Ω."""
        from datetime import datetime
        month = datetime.now().month
        
        if month in [12, 1, 2]:
            return "winter"
        elif month in [3, 4, 5]:
            return "spring"
        elif month in [6, 7, 8]:
            return "summer"
        else:
            return "autumn"
    
    def _is_female_name(self, name: str) -> bool:
        """–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∂–µ–Ω—Å–∫–æ–µ –ª–∏ –∏–º—è (–ø–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è–º)."""
        name_lower = name.lower().strip()
        
        # –ñ–µ–Ω—Å–∫–∏–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è
        female_endings = ['–∞', '—è', '–∏—è', '—å—è', '–Ω–∞', '–ª–∞', '—Ä–∞', '—Ç–∞', '–≤–∞', '–≥–∞']
        
        # –ñ–µ–Ω—Å–∫–∏–µ —Å—É—Ñ—Ñ–∏–∫—Å—ã –æ—Ç—á–µ—Å—Ç–≤
        female_suffixes = ['–µ–≤–Ω–∞', '–æ–≤–Ω–∞', '–∏—á–Ω–∞', '–∏–Ω–∏—á–Ω–∞']
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–∫–æ–Ω—á–∞–Ω–∏—è
        for ending in female_endings:
            if name_lower.endswith(ending):
                return True
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—Ñ—Ñ–∏–∫—Å—ã
        for suffix in female_suffixes:
            if suffix in name_lower:
                return True
        
        return False
    
    def _select_unique_component(self, components: List[str], used_components: set) -> Optional[str]:
        """–í—ã–±–∏—Ä–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–∑ —Å–ø–∏—Å–∫–∞."""
        available = [c for c in components if c not in used_components]
        
        if not available:
            # –ï—Å–ª–∏ –≤—Å–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –∏–ª–∏ –≤—ã–±–∏—Ä–∞–µ–º –ª—é–±–æ–π
            used_components.clear()
            available = components
        
        if available:
            component = random.choice(available)
            used_components.add(component)
            return component
        
        return None
    
    def _add_emoji(self, text: str, category: str = "general") -> str:
        """–î–æ–±–∞–≤–ª—è–µ—Ç —ç–º–æ–¥–∑–∏ –∫ —Ç–µ–∫—Å—Ç—É."""
        emojis = EMOJI_CATEGORIES.get(category, EMOJI_CATEGORIES["general"])
        
        # –° —à–∞–Ω—Å–æ–º 70% –¥–æ–±–∞–≤–ª—è–µ–º 1-3 —ç–º–æ–¥–∑–∏
        if random.random() < 0.7:
            num_emojis = random.randint(1, 3)
            selected_emojis = random.sample(emojis, min(num_emojis, len(emojis)))
            text += " " + "".join(selected_emojis)
        
        return text
    
    def generate_greeting(self, name: str, min_sentences: int = 3, max_sentences: int = 5) -> str:
        """
        –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ.
        
        Args:
            name: –∏–º—è –∏–º–µ–Ω–∏–Ω–Ω–∏–∫–∞
            min_sentences: –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
            max_sentences: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
        """
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–ª –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏
        is_female = self._is_female_name(name)
        season = self._get_season()
        
        # –°–æ–±–∏—Ä–∞–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
        sentences = []
        used_components = set()
        
        # 1. –ù–∞—á–∞–ª–æ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
        start = random.choice(GREETING_STARTS).format(name=name.split()[0])
        sentences.append(start)
        
        # 2. –û—Å–Ω–æ–≤–Ω–æ–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
        main_greeting = self._select_unique_component(MAIN_GREETINGS, used_components)
        if main_greeting:
            sentences.append(main_greeting)
        
        # 3. –ü–æ–∂–µ–ª–∞–Ω–∏—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, 1-2 —à—Ç—É–∫–∏)
        num_wishes = random.randint(1, 2)
        all_wishes = WISHES.copy()
        
        # –î–æ–±–∞–≤–ª—è–µ–º –≥–µ–Ω–¥–µ—Ä–Ω—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è
        if is_female:
            all_wishes.extend(FEMALE_SPECIFIC_WISHES)
        else:
            all_wishes.extend(MALE_SPECIFIC_WISHES)
        
        # –î–æ–±–∞–≤–ª—è–µ–º —Å–µ–∑–æ–Ω–Ω—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è
        all_wishes.extend(SEASONAL_WISHES.get(season, []))
        
        for _ in range(num_wishes):
            wish = self._select_unique_component(all_wishes, used_components)
            if wish:
                sentences.append(wish)
        
        # 4. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –¥–æ max_sentences
        if len(sentences) < max_sentences:
            # –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–∂–µ–ª–∞–Ω–∏–µ
            if random.random() > 0.5:  # 50% —à–∞–Ω—Å –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
                ending = self._select_unique_component(ENDINGS, used_components)
                if ending:
                    sentences.append(ending)
        
        # –û–±—ä–µ–¥–∏–Ω—è–µ–º –≤ —Ç–µ–∫—Å—Ç
        greeting_text = " ".join(sentences)
        
        # –î–æ–±–∞–≤–ª—è–µ–º —ç–º–æ–¥–∑–∏
        greeting_text = self._add_emoji(greeting_text)
        
        # –ï—Å–ª–∏ —Å–ª—É—á–∞–π–Ω–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å –º–µ–Ω—å—à–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ - –¥–æ–±–∞–≤–ª—è–µ–º –µ—â–µ
        while len(sentences) < min_sentences:
            extra_wish = random.choice(all_wishes)
            if extra_wish not in used_components:
                sentences.append(extra_wish)
                used_components.add(extra_wish)
                greeting_text += " " + extra_wish
        
        return greeting_text
    
    def generate_collective_greeting(self, names: List[str]) -> str:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–æ–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–º–µ–Ω–∏–Ω–Ω–∏–∫–æ–≤."""
        if not names:
            return ""
        
        names_str = ", ".join(names)
        
        # –í–∞—Ä–∏–∞–Ω—Ç—ã –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–π
        collective_templates = [
            "–î–æ—Ä–æ–≥–∏–µ {names}! –û—Ç –≤—Å–µ–π –¥—É—à–∏ –ø–æ–∑–¥—Ä–∞–≤–ª—è–µ–º –≤–∞—Å —Å –¥–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è! "
            "–ñ–µ–ª–∞–µ–º –≤–∞–º –∫—Ä–µ–ø–∫–æ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è, —Å—á–∞—Å—Ç—å—è –∏ —É—Å–ø–µ—Ö–æ–≤ –≤–æ –≤—Å–µ—Ö –Ω–∞—á–∏–Ω–∞–Ω–∏—è—Ö! "
            "–ü—É—Å—Ç—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –ø—Ä–∏–Ω–æ—Å–∏—Ç —Ä–∞–¥–æ—Å—Ç—å –∏ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–∏–µ! üéâüéÇ‚ú®",
            
            "–£–≤–∞–∂–∞–µ–º—ã–µ {names}! –°–µ—Ä–¥–µ—á–Ω–æ –ø–æ–∑–¥—Ä–∞–≤–ª—è–µ–º —Å –¥–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è! "
            "–ñ–µ–ª–∞–µ–º –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –ø–æ–±–µ–¥, –ª–∏—á–Ω–æ–≥–æ —Å—á–∞—Å—Ç—å—è –∏ –±–ª–∞–≥–æ–ø–æ–ª—É—á–∏—è! "
            "–ü—É—Å—Ç—å –∂–∏–∑–Ω—å –±—É–¥–µ—Ç –Ω–∞–ø–æ–ª–Ω–µ–Ω–∞ —è—Ä–∫–∏–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏ –∏ –ø—Ä–∏—è—Ç–Ω—ã–º–∏ —Å—é—Ä–ø—Ä–∏–∑–∞–º–∏! ü•≥üéäüåü",
            
            "–î–æ—Ä–æ–≥–∏–µ –∏–º–µ–Ω–∏–Ω–Ω–∏–∫–∏ {names}! –ü—Ä–∏–º–∏—Ç–µ —Å–∞–º—ã–µ —Ç—ë–ø–ª—ã–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è! "
            "–ñ–µ–ª–∞–µ–º –Ω–µ–∏—Å—Å—è–∫–∞–µ–º–æ–π —ç–Ω–µ—Ä–≥–∏–∏, –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è –∏ —É–¥–∞—á–∏! "
            "–ü—É—Å—Ç—å –≤—Å–µ –º–µ—á—Ç—ã —Å–±—ã–≤–∞—é—Ç—Å—è, –∞ –ø–ª–∞–Ω—ã —Ä–µ–∞–ª–∏–∑—É—é—Ç—Å—è! üí´üéÅ‚ù§Ô∏è"
        ]
        
        greeting = random.choice(collective_templates).format(names=names_str)
        
        # –î–æ–±–∞–≤–ª—è–µ–º —Å–µ–∑–æ–Ω–Ω—ã–µ —ç–º–æ–¥–∑–∏
        season = self._get_season()
        if season in EMOJI_CATEGORIES["seasonal"]:
            emoji = random.choice(EMOJI_CATEGORIES["seasonal"][season])
            greeting += f" {emoji}"
        
        return greeting

# –°–∏–Ω–≥–ª—Ç–æ–Ω-—ç–∫–∑–µ–º–ø–ª—è—Ä –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
_generator_instance = None

def get_generator() -> GreetingGenerator:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞."""
    global _generator_instance
    if _generator_instance is None:
        _generator_instance = GreetingGenerator()
    return _generator_instance

def generate_greeting(name: str, min_sentences: int = 3, max_sentences: int = 5) -> str:
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ (—É–¥–æ–±–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è)."""
    generator = get_generator()
    return generator.generate_greeting(name, min_sentences, max_sentences)

def generate_collective_greeting(names: List[str]) -> str:
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–æ–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ (—É–¥–æ–±–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è)."""
    generator = get_generator()
    return generator.generate_collective_greeting(names)

# –í –∫–æ–Ω–µ—Ü greetings_generator.py –¥–æ–±–∞–≤—å—Ç–µ:
class GreetingStatistics:
    """–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤."""
    
    def __init__(self):
        self.component_usage = {}
        self.total_generated = 0
    
    def record_usage(self, component_type: str, component: str):
        """–ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞."""
        key = f"{component_type}:{component}"
        self.component_usage[key] = self.component_usage.get(key, 0) + 1
    
    def get_usage_stats(self) -> dict:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è."""
        return {
            "total_generated": self.total_generated,
            "component_usage": self.component_usage
        }

# –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
class AdvancedGreetingGenerator(GreetingGenerator):
    """–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏."""
    
    def __init__(self):
        super().__init__()
        self.stats = GreetingStatistics()
    
    def generate_greeting(self, name: str, min_sentences: int = 3, max_sentences: int = 5) -> str:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ —Å –∑–∞–ø–∏—Å—å—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏."""
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –º–µ—Ç–æ–¥
        greeting = super().generate_greeting(name, min_sentences, max_sentences)
        
        # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        self.stats.total_generated += 1
        
        return greeting

# –ì–ª–æ–±–∞–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä —Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
_advanced_generator = None

def get_advanced_generator() -> AdvancedGreetingGenerator:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π."""
    global _advanced_generator
    if _advanced_generator is None:
        _advanced_generator = AdvancedGreetingGenerator()
    return _advanced_generator
